execute_process(COMMAND @MAVEN_EXECUTABLE@ checkstyle:checkstyle
                    -Dcheckstyle.config.location=@OIB_RESPONDER_SOURCE_DIR@/va-checker.xml
                WORKING_DIRECTORY @OIB_RESPONDER_SOURCE_DIR@
                OUTPUT_VARIABLE mvn_out
                ERROR_VARIABLE mvn_err)
foreach(dir ${SearchDirs})
  file(GLOB_RECURSE resultfiles ${dir}/*/checkstyle-result.xml) #@OIB_RESPONDER_SOURCE_DIR@/*/checkstyle-result.xml)
  foreach(file ${resultfiles})
    file(STRINGS ${file} output)
    foreach(line ${output})
      if(line MATCHES "\\<error")
        if(line MATCHES "severity=\"error\"")
          set(iserror True)
          string(REGEX MATCH "line=\"[0-9]+\"" Eloc ${line})
          string(REPLACE "line=" "" Eloc ${Eloc})
          string(REPLACE "\"" "" Eloc ${Eloc})
          string(REGEX MATCH "message=\".+\"" Emsg ${line})
          string(REPLACE "message=" "" Emsg ${Emsg})
          string(REPLACE "\"" "" Emsg ${Emsg})
       # Implement a check for an excepted style error
        if(EXISTS @OIB_RESPONDER_SOURCE_DIR/CheckstyleException/${namewe})
          file(STRINGS @OIB_RESPONDER_SOURCE_DIR/CheckstyleException/${namewe} exceptions)
          foreach(exception ${exceptions)
            if(exception STREQUAL "Line ${Eloc}: ${Emsg}")
               set(isError False)
             endif()
           endforeach()
          endif()
          if(iserror)
            message("Line ${Eloc}: ${Emsg}")
          endif()
        endif()
      elseif(line MATCHES "file name")
        string(REGEX MATCH "\"[a-zA-Z0-9/\\.-]+\"" fname ${line})
        if(fname)
          string(REPLACE "\"" "" fname ${fname})
          get_filename_component(namewe ${fname} NAME_WE)
          message("Checkstyle errors for: ${fname}")
        endif()
      endif()
    endforeach()
  endforeach()
endforeach()
